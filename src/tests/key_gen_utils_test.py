# pylint: skip-file
import unittest
from sympy import isprime
from src.key_gen_utils import KeyGenerator


class TestKeyGenerator(unittest.TestCase):
    def setUp(self):
        self.keygen = KeyGenerator()
    
    def test_constructor_creates_generator(self):
        self.assertIsNone(self.keygen.public_key)
        self.assertIsNone(self.keygen.private_key)

    def test_primes_are_distinct(self):
        primes = self.keygen.find_distinct_primes(512)
        self.assertNotEqual(primes[0], primes[1])

    def test_prime_test_returns_true_for_verified_prime(self):
        verified_prime = 2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399742821
        is_prime = True
        if not self.keygen.k_prime_tests(verified_prime):
            is_prime = False
        self.assertTrue(is_prime)

    def test_prime_test_returns_true_for_verified_prime_2(self):
        verified_prime = 64135289477071580278790190170577389084825014742943447208116859632024532344630238623598752668347708737661925585694639798853367
        is_prime = True
        if not self.keygen.k_prime_tests(verified_prime):
            is_prime = False
        self.assertTrue(is_prime)

    def test_prime_test_fails_for_semiprime(self):
        semiprime = 2140324650240744961264423072839333563008614715144755017797754920881418023447140136643345519095804679610992851872470914587687396261921557363047454770520805119056493106687691590019759405693457452230589325976697471681738069364894699871578494975937497937
        is_prime = True
        if not self.keygen.k_prime_tests(semiprime):
            is_prime = False
        self.assertFalse(is_prime)
    
    def test_prime_test_returns_true_for_primes(self):
        primes = [2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399742821,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399743577,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399743873,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399743931,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399744237,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399744459,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399744837,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399744927,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399745469,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399746441,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399746759,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399746873,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399747143,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399747657,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399748451,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399748707,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399748907,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399748983,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399749333,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399749793,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399749807,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399749907,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399750129,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399750363,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399750731,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399751637,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399752027,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399752697,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399753573,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399753759,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399753773,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399753801,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399754493,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399754797,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399756191,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399756477,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399756579,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399756813,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399756899,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399756993,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399757221,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399757581,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399757731,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399758169,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399758217,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399758351,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399758397,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399758517,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399758523,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399759963,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399759977,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399760073,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399761597,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399761799,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399762161,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399762303,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399762681,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399763347,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399763599,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399764069,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399764121,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399765683,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399766131,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399766853,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399767031,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399767387,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399767909,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399768533,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399768773,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399769299,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399769619,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399769703,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399769941,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399770907,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399770997,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399771941,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399772113,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399772151,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399772421,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399772433,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399772547,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399772841,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399772959,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399773007,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399773039,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399773111,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399773403,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399773823,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399773853,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399775097,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399775403,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399776127,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399777591,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399777867,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399778053,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399778433,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399778517,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399778641,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399778887,
        2499856796177491763759508785299725842866290120575138470858067744571954165845818765869202092388075475424521345616052888727535565798781930182410281399779469]
        
        for prime in primes:
            is_prime = True
            if not self.keygen.k_prime_tests(prime):
                is_prime = False
            self.assertTrue(is_prime)
    
    def test_prime_test_fails_for_composite(self):
        composites = [2114233572039927093329264411873630687347853999071713128333052787936051341499817652114226700263965235275165546729746671014940050240671466317025825350136320,
        10160213680730381201602096968578759235680759755053627067658607956410412400824474886741695931064459196687047437378108388317940185263946183177866242688685382,
        8100120921460061586425441434038163251104067237469874525157729920597061106996959781599486866158421280834874631966115969351329980605603306886285844396249834,
        3827864867890895185441141842389199012040583354092356685097860748872690683778749713601759587548712136541914552367429425283637442287272348664284298008776285,
        5035624270666848451162271439992053984864040693623312996600724489692361356489897535570177316777370101768553362547269638239838450745180457007148661553602103,
        8963039000900447743860914349454332325978399456097065961712737357159959550893561291345003188087952225470146399667962521540497631479994006202481491014701113,
        792590125785589102148803935332498927572832835029392113462320121845985219906220156421450492114077390275266038900066832737603741213109710177826384007015264,
        11176811197099558233786418724189692611362226140853012803801981442818004859928293649222939549446347902004442646709536160431007223928916461413455087527183867,
        8225729970997165247729172565226961008211723221459801104434785842574580052836958546164058013750541206130733852473374484244838280189030780879862689929914583,
        3612134260881767703803511055753461679838475556317553169923576206800344310574992863546218145267156542243861418342045842712335494142617534885605623482453664,
        1386205197103836569378033101479301702010836549094156913327691636003518500592183134660473358401561518254780439405226042837716029266700014844017806823444764,
        3846017125723462428315762269076450419976709866463600128119726714993123385151615402584727558956548216382118051554887683884998092278489066766784168542279129,
        12947136139834022897555295642581815707102169270334135240908262926869532612924685063933523098706330303858355442787077325599491970223008304831605494807039548,
        7206180950905786263602233142399955872254788810395872348086412119384930735837241822074418632743220710154835881062340582075423652321820728043821625609178236,
        3852291964668924561774430353275958445410995375009441781728996977037808778972576118710145114584512111168194635308866036478047846467096907019188188877238332,
        11795800671832507316501185498437957401096997561274955776718432792955122345675889688853937414491083616336602523771171944544292830001242189669609356836496159,
        12687156704018563856109549602263266718498557553305634981436436926417623106694076669868010797369108612093746059188969837148363181412984253304191882240756363,
        6102599985599064245196994093535573120904964828187279526307770191757514884220935343666495706193438180385252113523754120308575045107132243099090007210758501,
        2113836238401712777637819864161031625874773834925722889972689438564457906012091537052164695378992288021035834572867352334485613796568789663163873497402203,
        12640523633400774150414825464304881145724304227640220644740602380746712283615229697842938782377858733264768645394168716865956145127378519671769594284571785,
        10317691835950971012597346221170583145849623599680714239153833226615532601653799198971723262788905413619534645752615100064086329190433180247457729303476480,
        5450992403890374804900656846288452971515491686055911158896023627682976610914655125748376954896635828492871872662977588374286000067620797553889202499135062,
        2537049569926515459720120136959527207618831488796001103367179126159222091677635398951625824897595738585586151427491890209092442094884183974352628910591924,
        7409222163560085136094674184219488711132341113355749091021457994942182506138306090926350071297922486838326138670317425661147572410439743530064797742391268,
        9411602030893406855808517280904151500709196803661965974238372663981172811157555671381269769512696449722549307678474098444712449737100081913623480647946004,
        4731158038807913125891417457798805514739383559158482478139781990689981373653442531430300201841375462869359081254821490782059423724000502802775598956300895,
        5630155070902499790148407580302999195599610127900000622021711334285346385272808018284978160458728845794527409598489619535984981347590660387636938053136125,
        9470268755770722113360897629104821721992353493188932898647701607859256296291373312644531018452298863713478101155661094400146308006337890534950392423325434,
        8414680129453077918563089859555998541120927125360266844925613551218576865442481979787285260760830085990669929115805145051967934349306374706764302561427387,
        3427318123085841272720892010812619648559606988241846351877775454359453282228051486084624025372131689699885566844249299261325373124744213403944214142738965,
        7587121622484948206390346434084026971933918584761823493989973745124970994191236368918010833812531710063671816660737755964888410646293774355394122547795613,
        12834191715686980459249302353040906772542307159427563035306384648755136709042987693256233548944573769525211525056037617054571131652394114285465491885654652,
        4406404711545955257137031784124178324655698063371563624676837981672414731968083679463171864460597986352475219567100613717343071047815363422926406980519291,
        9779738927398149975225978624399954928410996327573634143289416866093567346701953158237713093202891603373160393015670636628283249420125294526284530629927002,
        6318920449259341837086901401315193880482993387867927659079388730512373664871097884989576941277157469669869182100382429914069059611336322775530484955225252,
        4383397461477872494309738680512799292635299313186089122055967916846337448614557198525763274397770150972212769692082457182040830630055856501156443242982562,
        4380139034337846621874329601578161388061853891771106223347053353474714574069130286968812234825016880700208834764165765204356038457566398666641407747816468,
        3066653896288104388602356049652715276013992579586787475035731817205158326387647757560516197190759377720849360082780436458426182423307958061599507522155782,
        8764240334190757430258730869355363617229366958995023457080284635343770643052737338145540588395287781234587559197994663438718939578521411802280904599047472,
        4264294645640937688628551537012163060337088455927063614270618311251522930697426033493457161663096367884541085971254637030435781344141991444632781357206180,
        9376794047072602798563840007302180093349707581067986900864420972338733415001202707343404505246082923053793071652329310173497960784056039590189593596294057,
        10020850506368801353449275198894694230524324795770795763460819992959310203679721928540148006635358852831324899249753184551342619306212377689732899705501159,
        4302576301201161392820749394026407566787851634563440912312106565218453967865959318056216930609611950084236149606956161602855253786942719282708940793295338,
        9922874922336984929502209462200353992321262423910793981004395618359360318764696364095831296875567856566678181864357988005683898206865366601036252429989522,
        9858569978459766572827591686003111254936045404811931580694805989774734786387063943675793348321776982216557248891203114301804639618751602757077520410457441,
        4980021747408317260739967456332834377300275976786911604183767599752845072784323339084353852457138996128950656675924906413120787172663175452418354149890434,
        3301666487709734233946795030495609603737760860349614884057676214699736896413071500299552551804661429205914667247855792792246412483412637388657225107306268,
        8289001820234851280679145476831942499716034815434030154927816583378013537645527085907403675374312462362387832792754345815205541901467531455599266387493471,
        12440547195921844996758104952849374928259530670695926979679422024741580356231383155653688943076686409596503207647712942427462577220652599753352183756378548,
        3478113058580485586360626696361925109309507634408251787417872199698883080474385367605652199970901386393735029413871681017764660764039246156085841236341161,
        11042496754166872341970650319903484034556335347697414257179595489624776568992797458892908190169454847419093997610711261088401097606797188164569601580721397,
        13238346730570327715583973809346798185681159488535335383837042417394043184990537118859846271623202835976149966186967024900888331231384515440959938698973060,
        1353501384891519111534089668006644075857145476665709908417881143288317603473177433254251105518506151407208055785848252749919804705858954132486808866500395,
        1681944627485459851560474569324821044161419719444648055530722981953769183471617369854889157823860110924137871323660763339799255659055189197804957441865800,
        3767718928922872388783593089086113709489259646043871213703511929759068106431183351195430775847035902058106300659207346561277351781630681241735904975249158,
        9481760884924805185581213539026092640792608504279900235380997812980790519232618960685695669968273014941979410278297755732207507252530039988392131307260887,
        4687508349196901709047636775649702020226127657190474188880640168943099971856144128599086003885450424910233604495285723294319826948135277587168249264419519,
        10092843679998813185057308262561185205068048773195469991689340073839042817368072820078229326795910583368317858470753682556778938940196904273978621419776944,
        11024737399647013499452246788338911228079559374497826704136708206965556826745421150280688185980766089440459418784371370435459653781517136763506964661043362,
        1976497427796051000018231242569370281051954347555103895298259187922693577945772850054338469700182185402864843724611649040965615640398307560543760973998282,
        10315687034448914602928507273150834288944425024472066553199254718221359594385243922645501865565010168232891299624463479339473402668764759295932878473820151,
        3144608948833089874667597507251042414261666386352840786072846989525102980448093039160359639578359597468817949290921501441510429732115743565568811359675159,
        566007023254553679469471662939941252629864138559723416844428634475695797874109231653235886061724252308430065877146578565593583351395380536949963410757634,
        6177032256737696662662512409299567871599939280096272136002791347942064176768272645459648050991864171798445869977358078027181557238137984200623975854713776,
        9634961607910378284000737123439292012182081588098770767552040284617151817614608748822183440236589055684064389396119655214736387846657083234621438000259094,
        2530210521953750603961350141089183616751783686356987737243035808070601513295452779925799536567820988716291824780533145139453071521785210090084646772514031,
        1486929237790773117465630437703570677175003231774667800489672597688965000230281505434483621945136008678395674200029366381456419219379224709091432459189658,
        1312934896495348303322079825554313428586356552689246539899275710311290767406538460844395417241311074539081291968416199698385607836787271542962109557789575,
        6862322047769034300642638482981008735982933011404721088790095146801122556035137092090226244379130625808151326269473563857364595937563349242755986773495003,
        595968977244849197848670400277668149970871218415487721851344764019482773296358621444032264391099953685985207268156354104287434468104693203506446388631193,
        8259010400189446223425968567768835851094065992288416122795387316327714070123643245415136358685776527774632790685856994974273253459609148985431225786456338,
        2279808770338272908222222592134605501285143444101589026213326228265227946447105614444885511189915493551967177625079780129454730802166916880784021544630514,
        11387180313508563475261909713538998147618535807293390581941794450573001728677844399481751231169239923964380596573949660061816463718614104781304164569793505,
        9712736998409491363062751196914305101734338663917373823360232535284430212566580652586012759643891292046955929555912906358565613049801118518082400280220770,
        3727475964289919816692039480862425345804980268470772955514351353080802877377491635800052399319397129032165740083198262957148617526130245234169435676610895,
        1078501192686062541850606107102086717615953970118386182504671948582459199271328099564836576501011967950751373096297644820722788273034780614120893467506395,
        9955963056453777343966658381304108186293203020929965349875843849185717132882131853267139868986387266699653169132275729924673491458929987135698124558508454,
        5348249285547864731962871479187859221773399619717768673282010940395079192677785669403500305116670688288818998007051196528378522307124345073464343541470107,
        12058980369755018773928681775195171774744578648266691434393672025806601496036026699343684479688713495460909902524070288606997170966674339594755698303121998,
        4534704364685081055686337948005054711907353729476498872453208657734273950754328181148886821657012770536064555894866546929460249293830135917617719009598186,
        11805942129672736187177430173136045388416840559915520317206445439009442124529290866999133741795097561568377483538343680239692083763193879449080495342116731,
        12812414302222575086716863099681662678663328722838784328882241942172360608015597992221264120175078841903129631052462941108231523929173598295604412025859127,
        3177095865028921308515455112493777603153551534434026085041040198430226019845612126307690594239865881014496414963553697324146531822029606809760713283433242,
        7950371510075291601357450901213240252774287885293750000927380037067848284522713591084947927990293470690876676702297768968630176913465625954339963843086225,
        4798472231594416083285607014651983437748312565423697191378795617199945026788419418531935674712701882891674951622690811230220803198545330875388995728424899,
        9565997025097728694822809731957543081659221317250268946795647705640246495446104071957394918975750251263340656669989621043110057128247193128630265869067035,
        556879405645868980146080415811728756087558422218147305418577797228655319948553505710594321397412861528093576216909466281387253917880915106699082591440272,
        7717597373064617951958543174526269225587494742643259320505002741565539336359759909827908694939635732548214674664742374058534207178914163339608852845741296,
        6449435055318116820440834517790121721207890281009895907122730164597113125397133309541232694788245245429458022470010452529040671575829477112459732703519685,
        9170009655497460453327279982184398656001070741907462894236431001634898928451520178528134874069118265855848845796018210121357336823141818547005888921624955,
        9155509565855249180994747732683407804231393181459924984136306698225692643758435291938823798971821566796182041918738120023679821162825331807831902462430956,
        11924744508288991356105113705853671633529160502360446977934599510266829298581561557616384484438318547862028182539003938377286247617697075376665544152160747,
        245540949992213140263914138886714250222801948983643364165114453230578066688309315390612999732001567945560060428425359749020363335728805468973837361466295,
        10356339051267016911348061710659083227798628734772143383448896856070699833010534634333754296089906598641439040024330064007315735383763890978920343486477562,
        7557380220198731389807668524108434940501096934696813685987229524734080664542476523851577906734077405122873003068990602488371435337210947843521686009209170,
        5088071387960217858165101337261638596562465557281307065767388961254634713440142664252194745238978268055014855538696000265082594825313496465196063410629776,
        562773010533407542035927413880616733314733169086620844823714672415275681903527974673167600470836004116564065357967758205649025850476925858961269412754047,
        8090819492200512257094993102771192574245217895539405876568673778395162029766501159946206824075489678444465981504849694420771546280009368268580877451202067,
        6180325017644368486100700076672249230653861594268432063842630255662181676664282705712631959074573397374665948817048869804572020982005981232261005967778417,
        11043477750543606289660626541421350080211833110607967091105087120009820309140489429311566414357717901649525348437094439356780287848553708085857458651063354]

        for composite in composites:
            is_prime = True
            if not self.keygen.k_prime_tests(composite):
                is_prime = False
            self.assertFalse(is_prime)
    
    def test_prime_test_fails_for_semi_primes(self):
        semiprimes = [6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032626685167443316046122061829927445685591624849381048584193612793817629700931841205074864201475193528092469093100461636051884185829085221896966890987722096297253,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032628340072642385545669670624743314104099602333440869325861320834664536334589631137097869613260354434057200126231259463064221814373644015534747646594008736687723,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032628865042569582818940060121588227046526604254366190104940201028890896444964458759038702145699755929907039275713838834170854596842461759740085952753102686756749,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032628425067773455580389638448042014294778259787304968880569330008967851781031269894935909166131495628623364559957010408862438550582881174120373848543576332572049,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032628935038559875788709445387834215438850204510489566208817385054787744459681102441964146483358342796020351162311516083651738967838304125634131060240981884173049,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032628775047724920429236564779271956256396261067921849399955250138452091854614488309563130854424429959189923992945396656266860405562093003590599385982972303195669,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032626235193220004097604585118346091734939908917159345059268858341623606749181988957697007745098563674506892679258250746531913229427241441149534057137070166733089,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032625700223865622114367140583466037593609535531073541979636094715126268350990497952481111735850792626355151831690288911213725536816160501816475021336850622207011,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032625325245346195490602576657148242634733105587555455708865466004964582557865621079666231355536934415033838153488446503280416406481290684526947659794640665277669,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032627685110161787042827565633441565575928771365429278639581956020915458482598179532581211882312148758282638901638708057207375200055404734669039855100282033071893,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032628445066627825000323748524112296692585002717625933481677096873509808356664596661486036119748234733227167956127775337285548370867407564375815307825827558317081,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032628265076938500220916757839479755112324316344737252071707195092632199175964655762534893537197582791792937390590890981477559988306670052076842174285566777327229,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032626750163720016660907919577155863478463539372924183537793855103578988571740153196362776800729595618054830130655447653426991101753795990227151633655038532294671,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032626360186059812972192773093785356721232052231665373816192401245010835346890281248635301205203183078280663905325531549176349606205531380246043177651140174250739,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032627370128205468678865331935334617810472570212874086172134627904379642416373282959416712362848507860772735411949160434543395530574114088145836871404825675464287,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032625745221287953309218888254624172988674707124295712332128570160345670646165483177218897381488455611713709473074510000165722632456344879891218304721915839554817,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032625325245346195490602576657148242634733105587555455708865466004964582557865621079666231355536934415033838153488446503280416406481290684526947659794640682103241,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032624930267972399446903902654760165278049932713716404836987070430260940189107417440301224021606337099108721079115839166923997455861894476981978838970179521868807,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032625250249642310165849663871884683642957819598851838454711340262932245399240645705103255279474162772769575417848078021693754580414316721069042187486198690062031,
        6249284001394793599767972419308910366662774195936301330158694442469590477273508168737465005200239186530155264373734781315628077205138221140290008032626150198088934062884617295047391544261251463295245504560849167320291302740350199858968192227422479940728245532499800733696493218004282563907855187502600039951]

        for semiprime in semiprimes:
            is_prime = True
            if not self.keygen.k_prime_tests(semiprime):
                is_prime = False
            self.assertFalse(is_prime)

    def test_prime_test_returns_false_for_composite(self):
        composite = 11794051520578639372735469069180758408079391665362167045751736311657604863408765101046999322821353345357387627280987559870289520921156781759163203476682792
        is_prime = True
        if not self.keygen.k_prime_tests(composite):
            is_prime = False
        self.assertFalse(is_prime)

    def test_generate_prime_returns_probable_prime(self):
        probable_prime = self.keygen.generate_prime()
        self.assertTrue(isprime(probable_prime))

    def test_gcd_returns_1_for_primes(self):
        primes = [1000000000039, 
            1000000000061, 
            1000000000063, 
            1000000000091, 
            1000000000121, 
            1000000000163, 
            1000000000169, 
            1000000000177, 
            1000000000189, 
            1000000000193, 
            1000000000211, 
            1000000000271, 
            1000000000303, 
            1000000000331, 
            1000000000333, 
            1000000000339]
        for i in range(8):
            gcd = self.keygen.gcd(primes[i], primes[len(primes)-i-1])
            self.assertEqual(gcd, 1)
    
    def test_gcd_found_for_even_numbers(self):
        gcd = self.keygen.gcd(10, 20)
        self.assertEqual(gcd, 10)
        gcd = self.keygen.gcd(1000,1300)
        self.assertEqual(gcd, 100)
